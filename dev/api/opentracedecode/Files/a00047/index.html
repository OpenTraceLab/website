
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Open-source logic analysis â€” capture, view, and decode traces.">
      
      
      
        <link rel="canonical" href="https://opentracelab.github.io/website/dev/api/opentracedecode/Files/a00047/">
      
      
      
      
      <link rel="icon" href="../../../../docs-assets/logos/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>type_decoder.c - OpenTraceLab</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../overrides/assets/styles/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#type_decoderc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="OpenTraceLab" class="md-header__button md-logo" aria-label="OpenTraceLab" data-md-component="logo">
      
  <img src="../../../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenTraceLab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              type_decoder.c
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/OpenTraceLab/website" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    OpenTraceLab/website
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../get-started/install/" class="md-tabs__link">
          
  
  
  Get started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../opentracecapture/overview/" class="md-tabs__link">
          
  
  
  OpenTraceCapture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../opentraceview/overview/" class="md-tabs__link">
          
  
  
  OpenTraceView

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../opentracedecode/overview/" class="md-tabs__link">
          
  
  
  OpenTraceDecode

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../opentracebroadcaster/overview/" class="md-tabs__link">
          
  
  
  OpenTraceBroadcaster

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../hardware/supported-hardware/" class="md-tabs__link">
          
  
  
  Hardware

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../community/contributing/" class="md-tabs__link">
          
  
  
  Community

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../about/mission/" class="md-tabs__link">
          
  
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../legal/license/" class="md-tabs__link">
          
  
  
  Legal

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="OpenTraceLab" class="md-nav__button md-logo" aria-label="OpenTraceLab" data-md-component="logo">
      
  <img src="../../../../logo.png" alt="logo">

    </a>
    OpenTraceLab
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OpenTraceLab/website" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    OpenTraceLab/website
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Get started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Get started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../get-started/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../get-started/capture-first-trace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Capture your first trace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../get-started/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OpenTraceCapture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            OpenTraceCapture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opentracecapture/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    C (core)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            C (core)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture/namespaces.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Namespaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture/classes.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    C++ bindings
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            C++ bindings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture-cxx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture-cxx/namespaces.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Namespaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture-cxx/classes.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture-java/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java bindings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentracecapture-python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python bindings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OpenTraceView
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            OpenTraceView
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opentraceview/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opentraceview/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentraceview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentraceview/namespaces.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Namespaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../opentraceview/classes.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OpenTraceDecode
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            OpenTraceDecode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opentracedecode/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opentracedecode/decoder-howto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decoder HOWTO
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opentracedecode/decoder-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decoder API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../namespaces.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Namespaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../classes.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OpenTraceBroadcaster
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            OpenTraceBroadcaster
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../opentracebroadcaster/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Hardware
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Hardware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/supported-hardware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supported Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Logic Analyzers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Logic Analyzers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/logic-analyzer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/logic-analyzer/fx2lafw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FX2-based Devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/logic-analyzer/saleae-logic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Saleae Logic Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/logic-analyzer/kingst-la-series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kingst LA Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/logic-analyzer/openbench-logic-sniffer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenBench LogicSniffer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Multimeters
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Multimeters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/multimeter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/multimeter/uni-t/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UNI-T Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/multimeter/voltcraft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Voltcraft Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/multimeter/brymen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Brymen Series
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Oscilloscopes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Oscilloscopes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/oscilloscope/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/oscilloscope/rigol-ds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rigol DS Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/oscilloscope/hantek-dso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hantek DSO Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/oscilloscope/siglent-sds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Siglent SDS Series
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Power Supplies
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Power Supplies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/power-supply/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/power-supply/korad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Korad Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/power-supply/rigol-dp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rigol DP Series
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Function Generators
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            Function Generators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/function-generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Thermometers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Thermometers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../hardware/thermometer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/code-of-conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/governance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Governance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../community/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/mission/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mission
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roadmap
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Legal
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Legal
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../legal/license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../legal/attribution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Attribution
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
                  


  
    <a href="https://github.com/OpenTraceLab/website/edit/main/docs/api/opentracedecode/Files/a00047.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/OpenTraceLab/website/raw/main/docs/api/opentracedecode/Files/a00047.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>
    </a>
  


<h1 id="type_decoderc">type_decoder.c<a class="headerlink" href="#type_decoderc" title="Permanent link">&para;</a></h1>
<h2 id="classes">Classes<a class="headerlink" href="#classes" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>struct</td>
<td><strong><a href="Classes/a00160.md">otd_Decoder</a></strong></td>
</tr>
</tbody>
</table>
<h2 id="functions">Functions<a class="headerlink" href="#functions" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="Files/a00035.md#define-otd-priv">OTD_PRIV</a> const char *</td>
<td><strong><a href="Files/a00047.md#function-output-type-name">output_type_name</a></strong>(unsigned int idx)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="Files/a00047.md#function-release-annotation">release_annotation</a></strong>(struct <a href="Classes/a00116.md">otd_proto_data_annotation</a> * pda)</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-convert-annotation">convert_annotation</a></strong>(struct <a href="Classes/a00104.md">otd_decoder_inst</a> * di, PyObject * obj, struct <a href="Classes/a00112.md">otd_proto_data</a> * pdata)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="Files/a00047.md#function-release-logic">release_logic</a></strong>(struct <a href="Classes/a00124.md">otd_proto_data_logic</a> * pdl)</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-convert-logic">convert_logic</a></strong>(struct <a href="Classes/a00104.md">otd_decoder_inst</a> * di, PyObject * obj, struct <a href="Classes/a00112.md">otd_proto_data</a> * pdata)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="Files/a00047.md#function-release-binary">release_binary</a></strong>(struct <a href="Classes/a00120.md">otd_proto_data_binary</a> * pdb)</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-convert-binary">convert_binary</a></strong>(struct <a href="Classes/a00104.md">otd_decoder_inst</a> * di, PyObject * obj, struct <a href="Classes/a00112.md">otd_proto_data</a> * pdata)</td>
</tr>
<tr>
<td>struct <a href="Classes/a00104.md">otd_decoder_inst</a> *</td>
<td><strong><a href="Files/a00047.md#function-otd-sess-inst-find-by-obj">otd_sess_inst_find_by_obj</a></strong>(struct <a href="Classes/a00156.md">otd_session</a> * sess, const GSList * stack, const PyObject * obj)</td>
</tr>
<tr>
<td>struct <a href="Classes/a00104.md">otd_decoder_inst</a> *</td>
<td><strong><a href="Files/a00047.md#function-otd-inst-find-by-obj">otd_inst_find_by_obj</a></strong>(const GSList * stack, const PyObject * obj)<br>Find a decoder instance by its Python object.</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-convert-meta">convert_meta</a></strong>(struct <a href="Classes/a00112.md">otd_proto_data</a> * pdata, PyObject * obj)</td>
</tr>
<tr>
<td>void</td>
<td><strong><a href="Files/a00047.md#function-release-meta">release_meta</a></strong>(GVariant * gvar)</td>
</tr>
<tr>
<td></td>
<td><strong><a href="Files/a00047.md#function-pydoc-strvar">PyDoc_STRVAR</a></strong>(Decoder_put_doc , "Put an annotation for the specified span of samples.\n" "\n" "Arguments: start and end sample number, stream id, annotation data.\n" "Annotation data 's layout depends on the output stream type." )</td>
</tr>
<tr>
<td>PyObject *</td>
<td><strong><a href="Files/a00047.md#function-decoder-put">Decoder_put</a></strong>(PyObject * self, PyObject * args)</td>
</tr>
<tr>
<td></td>
<td><strong><a href="Files/a00047.md#function-pydoc-strvar">PyDoc_STRVAR</a></strong>(Decoder_register_doc , "Register a new output stream." )</td>
</tr>
<tr>
<td>PyObject *</td>
<td><strong><a href="Files/a00047.md#function-decoder-register">Decoder_register</a></strong>(PyObject * self, PyObject * args, PyObject * kwargs)</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-get-term-type">get_term_type</a></strong>(const char * v)</td>
</tr>
<tr>
<td>PyObject *</td>
<td><strong><a href="Files/a00047.md#function-get-current-pinvalues">get_current_pinvalues</a></strong>(const struct <a href="Classes/a00104.md">otd_decoder_inst</a> * di)<br>Get the pin values at the current sample number.</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-create-term-list">create_term_list</a></strong>(struct <a href="Classes/a00104.md">otd_decoder_inst</a> * di, PyObject * py_dict, GSList ** term_list)<br>Create a list of terms in the specified condition.</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-set-new-condition-list">set_new_condition_list</a></strong>(PyObject * self, PyObject * args)<br>Replace the current condition list with the new one.</td>
</tr>
<tr>
<td>int</td>
<td><strong><a href="Files/a00047.md#function-set-skip-condition">set_skip_condition</a></strong>(struct <a href="Classes/a00104.md">otd_decoder_inst</a> * di, uint64_t count)<br>Create a SKIP condition list for condition-less .wait() calls.</td>
</tr>
<tr>
<td></td>
<td><strong><a href="Files/a00047.md#function-pydoc-strvar">PyDoc_STRVAR</a></strong>(Decoder_wait_doc , "Wait for one or more conditions to occur.\n" "\n" "Returns the sample data at the next position where the condition\n" "is seen. When the optional condition is missing or empty, the next\n" "sample number is used. The condition can be a dictionary with one\n" "condition 's details, or a list of dictionaries specifying multiple\n" "conditions of which at least one condition must be true. Dicts can\n" "contain one or more key/value pairs, all of which must be true for\n" "the dict 's condition to be considered true. The key either is a\n" "channel index or a keyword, the value is the operation 's parameter.\n" "\n" "Supported parameters for channel number keys:'h' , 'l' , 'r' , 'f' , \n" "or 'e' for level or edge conditions. Other supported keywords:\n" " 'skip' to advance over the given number of samples.\n" )</td>
</tr>
<tr>
<td>PyObject *</td>
<td><strong><a href="Files/a00047.md#function-decoder-wait">Decoder_wait</a></strong>(PyObject * self, PyObject * args)</td>
</tr>
<tr>
<td></td>
<td><strong><a href="Files/a00047.md#function-pydoc-strvar">PyDoc_STRVAR</a></strong>(Decoder_has_channel_doc , "Check whether <a href="Files/a00011.md#define-input">input</a> data is supplied for a given channel.\n" "\n" "Argument: A channel index.\n" "Returns: A boolean, True if the channel is connected, \n" "False if the channel is open(won 't see any <a href="Files/a00011.md#define-input">input</a> data).\n" )</td>
</tr>
<tr>
<td>PyObject *</td>
<td><strong><a href="Files/a00047.md#function-decoder-has-channel">Decoder_has_channel</a></strong>(PyObject * self, PyObject * args)<br>Return whether the specified channel was supplied to the decoder.</td>
</tr>
<tr>
<td></td>
<td><strong><a href="Files/a00047.md#function-pydoc-strvar">PyDoc_STRVAR</a></strong>(Decoder_doc , "sigrok Decoder base class" )</td>
</tr>
</tbody>
</table>
<h2 id="attributes">Attributes<a class="headerlink" href="#attributes" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th></th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>PyMethodDef[]</td>
<td><strong><a href="Files/a00047.md#variable-decoder-methods">Decoder_methods</a></strong></td>
</tr>
</tbody>
</table>
<h2 id="functions-documentation">Functions Documentation<a class="headerlink" href="#functions-documentation" title="Permanent link">&para;</a></h2>
<h3 id="function-output_type_name">function output_type_name<a class="headerlink" href="#function-output_type_name" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">OTD_PRIV</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">output_type_name</span><span class="p">(</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-release_annotation">function release_annotation<a class="headerlink" href="#function-release_annotation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_annotation</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_annotation</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pda</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-convert_annotation">function convert_annotation<a class="headerlink" href="#function-convert_annotation" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_annotation</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">di</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pdata</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-release_logic">function release_logic<a class="headerlink" href="#function-release_logic" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_logic</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_logic</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pdl</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-convert_logic">function convert_logic<a class="headerlink" href="#function-convert_logic" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_logic</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">di</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pdata</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-release_binary">function release_binary<a class="headerlink" href="#function-release_binary" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_binary</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_binary</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pdb</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-convert_binary">function convert_binary<a class="headerlink" href="#function-convert_binary" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_binary</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">di</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">obj</span><span class="p">,</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pdata</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-otd_sess_inst_find_by_obj">function otd_sess_inst_find_by_obj<a class="headerlink" href="#function-otd_sess_inst_find_by_obj" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">otd_sess_inst_find_by_obj</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_session</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sess</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">stack</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">obj</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-otd_inst_find_by_obj">function otd_inst_find_by_obj<a class="headerlink" href="#function-otd_inst_find_by_obj" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">otd_inst_find_by_obj</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">stack</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">obj</span>
<span class="p">)</span>
</code></pre></div>
<p>Find a decoder instance by its Python object. </p>
<p><strong>Parameters</strong>: </p>
<ul>
<li><strong>stack</strong> Pointer to a GSList of struct <a href="Classes/a00104.md">otd_decoder_inst</a>, indicating the stack to search. To start searching at the bottom level of decoder instances, pass NULL. </li>
<li><strong>obj</strong> The Python class instantiation.</li>
</ul>
<p><strong>Return</strong>: Pointer to struct <a href="Classes/a00104.md">otd_decoder_inst</a>, or NULL if not found.</p>
<p><strong>Since</strong>: 0.1.0 </p>
<p>I.e. find that instance's instantiation of the opentracedecode.Decoder class. This will recurse to find the instance anywhere in the stack tree of all sessions.</p>
<h3 id="function-convert_meta">function convert_meta<a class="headerlink" href="#function-convert_meta" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_meta</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pdata</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">obj</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-release_meta">function release_meta<a class="headerlink" href="#function-release_meta" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_meta</span><span class="p">(</span>
<span class="w">    </span><span class="n">GVariant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">gvar</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-pydoc_strvar">function PyDoc_STRVAR<a class="headerlink" href="#function-pydoc_strvar" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">PyDoc_STRVAR</span><span class="p">(</span>
<span class="w">    </span><span class="n">Decoder_put_doc</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Put an annotation for the specified span of samples.</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;Arguments: start and end sample number,</span>
<span class="w">    </span><span class="n">stream</span><span class="w"> </span><span class="n">id</span><span class="p">,</span>
<span class="w">    </span><span class="n">annotation</span><span class="w"> </span><span class="n">data</span><span class="p">.</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">Annotation</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">layout</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">type</span><span class="p">.</span><span class="s">&quot; </span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-decoder_put">function Decoder_put<a class="headerlink" href="#function-decoder_put" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Decoder_put</span><span class="p">(</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">args</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-pydoc_strvar_1">function PyDoc_STRVAR<a class="headerlink" href="#function-pydoc_strvar_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">PyDoc_STRVAR</span><span class="p">(</span>
<span class="w">    </span><span class="n">Decoder_register_doc</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Register a new output stream.&quot;</span><span class="w"> </span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-decoder_register">function Decoder_register<a class="headerlink" href="#function-decoder_register" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Decoder_register</span><span class="p">(</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">args</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-get_term_type">function get_term_type<a class="headerlink" href="#function-get_term_type" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">get_term_type</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-get_current_pinvalues">function get_current_pinvalues<a class="headerlink" href="#function-get_current_pinvalues" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">get_current_pinvalues</span><span class="p">(</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">di</span>
<span class="p">)</span>
</code></pre></div>
<p>Get the pin values at the current sample number. </p>
<p><strong>Parameters</strong>: </p>
<ul>
<li><strong>di</strong> The decoder instance to use. Must not be NULL. The number of channels must be &gt;= 1.</li>
</ul>
<p><strong>Return</strong>: A newly allocated PyTuple containing the pin values at the current sample number. </p>
<h3 id="function-create_term_list">function create_term_list<a class="headerlink" href="#function-create_term_list" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">create_term_list</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">di</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">py_dict</span><span class="p">,</span>
<span class="w">    </span><span class="n">GSList</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">term_list</span>
<span class="p">)</span>
</code></pre></div>
<p>Create a list of terms in the specified condition. </p>
<p><strong>Parameters</strong>: </p>
<ul>
<li><strong>di</strong> The decoder instance to use. Must not be NULL. </li>
<li><strong>py_dict</strong> A Python dict containing terms. Must not be NULL. </li>
<li><strong>term_list</strong> Pointer to a GSList which will be set to the newly created list of terms. Must not be NULL.</li>
</ul>
<p><strong>Return</strong>: OTD_OK upon success, a negative error code otherwise. </p>
<p>If there are no terms in the condition, 'term_list' will be NULL.</p>
<h3 id="function-set_new_condition_list">function set_new_condition_list<a class="headerlink" href="#function-set_new_condition_list" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">set_new_condition_list</span><span class="p">(</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">args</span>
<span class="p">)</span>
</code></pre></div>
<p>Replace the current condition list with the new one. </p>
<p><strong>Parameters</strong>: </p>
<ul>
<li><strong>self</strong> TODO. Must not be NULL. </li>
<li><strong>args</strong> TODO. Must not be NULL.</li>
</ul>
<p><strong>Returns</strong>: </p>
<ul>
<li><strong>OTD_OK</strong> The new condition list was set successfully. </li>
<li><strong>OTD_ERR</strong> There was an error setting the new condition list. The contents of di-&gt;condition_list are undefined. </li>
<li><strong>9999</strong> TODO. </li>
</ul>
<h3 id="function-set_skip_condition">function set_skip_condition<a class="headerlink" href="#function-set_skip_condition" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">set_skip_condition</span><span class="p">(</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">di</span><span class="p">,</span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">count</span>
<span class="p">)</span>
</code></pre></div>
<p>Create a SKIP condition list for condition-less .wait() calls. </p>
<p><strong>Parameters</strong>: </p>
<ul>
<li><strong>di</strong> Decoder instance. </li>
<li><strong>count</strong> Number of samples to skip.</li>
</ul>
<p><strong>Returns</strong>: </p>
<ul>
<li><strong>OTD_OK</strong> The new condition list was set successfully. </li>
<li><strong>OTD_ERR</strong> There was an error setting the new condition list. The contents of di-&gt;condition_list are undefined.</li>
</ul>
<p>This routine is a reduced and specialized version of the set_new_condition_list() and create_term_list() routines which gets invoked when .wait() was called without specifications for conditions. This minor duplication of the SKIP term list creation simplifies the logic and avoids the creation of expensive Python objects with "constant" values which the caller did not pass in the first place. It results in maximum sharing of match handling code paths. </p>
<h3 id="function-pydoc_strvar_2">function PyDoc_STRVAR<a class="headerlink" href="#function-pydoc_strvar_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">PyDoc_STRVAR</span><span class="p">(</span>
<span class="w">    </span><span class="n">Decoder_wait_doc</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Wait for one or more conditions to occur.</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;Returns the sample data at the next position where the condition</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;is seen. When the optional condition is missing or empty,</span>
<span class="w">    </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">sample</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dictionary</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">one</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">condition</span><span class="w"> </span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">details</span><span class="p">,</span>
<span class="w">    </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">dictionaries</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">multiple</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">conditions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">least</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nb">true</span><span class="p">.</span><span class="w"> </span><span class="n">Dicts</span><span class="w"> </span><span class="n">can</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">contain</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">key</span><span class="o">/</span><span class="n">value</span><span class="w"> </span><span class="n">pairs</span><span class="p">,</span>
<span class="w">    </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="k">for</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">the</span><span class="w"> </span><span class="n">dict</span><span class="w"> </span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">considered</span><span class="w"> </span><span class="nb">true</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">channel</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">keyword</span><span class="p">,</span>
<span class="w">    </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operation</span><span class="w"> </span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">parameter</span><span class="p">.</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">Supported</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">keys</span><span class="o">:</span><span class="sc">&#39;h&#39;</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="sc">&#39;l&#39;</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="sc">&#39;f&#39;</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="k">or</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">edge</span><span class="w"> </span><span class="n">conditions</span><span class="p">.</span><span class="w"> </span><span class="n">Other</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">keywords</span><span class="o">:</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="err">&#39;</span><span class="n">skip</span><span class="err">&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">advance</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">samples</span><span class="p">.</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; </span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-decoder_wait">function Decoder_wait<a class="headerlink" href="#function-decoder_wait" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Decoder_wait</span><span class="p">(</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">args</span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-pydoc_strvar_3">function PyDoc_STRVAR<a class="headerlink" href="#function-pydoc_strvar_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">PyDoc_STRVAR</span><span class="p">(</span>
<span class="w">    </span><span class="n">Decoder_has_channel_doc</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;Check whether input data is supplied for a given channel.</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;Argument: A channel index.</span><span class="se">\n</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&quot;Returns: A boolean,</span>
<span class="w">    </span><span class="n">True</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">connected</span><span class="p">,</span>
<span class="w">    </span><span class="err">\</span><span class="n">n</span><span class="s">&quot; &quot;</span><span class="n">False</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">won</span><span class="w"> </span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">data</span><span class="p">).</span><span class="err">\</span><span class="n">n</span><span class="s">&quot; </span>
<span class="p">)</span>
</code></pre></div>
<h3 id="function-decoder_has_channel">function Decoder_has_channel<a class="headerlink" href="#function-decoder_has_channel" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Decoder_has_channel</span><span class="p">(</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">,</span>
<span class="w">    </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">args</span>
<span class="p">)</span>
</code></pre></div>
<p>Return whether the specified channel was supplied to the decoder. </p>
<p><strong>Parameters</strong>: </p>
<ul>
<li><strong>self</strong> TODO. Must not be NULL. </li>
<li><strong>args</strong> TODO. Must not be NULL.</li>
</ul>
<p><strong>Returns</strong>: </p>
<ul>
<li><strong>Py_True</strong> The channel has been supplied by the frontend. </li>
<li><strong>Py_False</strong> The channel has been supplied by the frontend. </li>
<li><strong>NULL</strong> An error occurred. </li>
</ul>
<h3 id="function-pydoc_strvar_4">function PyDoc_STRVAR<a class="headerlink" href="#function-pydoc_strvar_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">PyDoc_STRVAR</span><span class="p">(</span>
<span class="w">    </span><span class="n">Decoder_doc</span><span class="w"> </span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;sigrok Decoder base class&quot;</span><span class="w"> </span>
<span class="p">)</span>
</code></pre></div>
<h2 id="attributes-documentation">Attributes Documentation<a class="headerlink" href="#attributes-documentation" title="Permanent link">&para;</a></h2>
<h3 id="variable-decoder_methods">variable Decoder_methods<a class="headerlink" href="#variable-decoder_methods" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="n">PyMethodDef</span><span class="p">[]</span><span class="w"> </span><span class="n">Decoder_methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;put&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">Decoder_put</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="p">,</span>
<span class="w">      </span><span class="n">Decoder_put_doc</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;register&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="p">(</span><span class="n">PyCFunction</span><span class="p">)(</span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">void</span><span class="p">))</span><span class="n">Decoder_register</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">METH_KEYWORDS</span><span class="p">,</span>
<span class="w">      </span><span class="n">Decoder_register_doc</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;wait&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">Decoder_wait</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="p">,</span>
<span class="w">      </span><span class="n">Decoder_wait_doc</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;has_channel&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">Decoder_has_channel</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="p">,</span>
<span class="w">      </span><span class="n">Decoder_has_channel_doc</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">ALL_ZERO</span><span class="p">,</span>
<span class="p">};</span>
</code></pre></div>
<h2 id="source-code">Source code<a class="headerlink" href="#source-code" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="cm">/*</span>
<span class="cm"> * This file is part of the libopentracedecode project.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2012 Bert Vermeulen &lt;bert@biot.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software: you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation, either version 3 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="cm"> */</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;config.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;libopentracedecode-internal.h&quot;</span><span class="c1"> /* First, so we avoid a _POSIX_C_SOURCE warning. */</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;opentracedecode/libopentracedecode.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;inttypes.h&gt;</span>

<span class="cm">/** @cond PRIVATE */</span>
<span class="k">extern</span><span class="w"> </span><span class="n">OTD_PRIV</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">sessions</span><span class="p">;</span>
<span class="cm">/** @endcond */</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">PyObject_HEAD</span>
<span class="p">}</span><span class="w"> </span><span class="n">otd_Decoder</span><span class="p">;</span>

<span class="cm">/* This is only used for nicer otd_dbg() output. */</span>
<span class="n">OTD_PRIV</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">output_type_name</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">names</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s">&quot;OUTPUT_ANN&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;OUTPUT_PYTHON&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;OUTPUT_BINARY&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;OUTPUT_LOGIC&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;OUTPUT_META&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;(invalid)&quot;</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">names</span><span class="p">[</span><span class="n">MIN</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">G_N_ELEMENTS</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_annotation</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_annotation</span><span class="w"> </span><span class="o">*</span><span class="n">pda</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pda</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pda</span><span class="o">-&gt;</span><span class="n">ann_text</span><span class="p">)</span>
<span class="w">                </span><span class="n">g_strfreev</span><span class="p">(</span><span class="n">pda</span><span class="o">-&gt;</span><span class="n">ann_text</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_annotation</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="p">,</span>
<span class="w">                </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="n">pdata</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_tmp</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_pd_output</span><span class="w"> </span><span class="o">*</span><span class="n">pdo</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_annotation</span><span class="w"> </span><span class="o">*</span><span class="n">pda</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ann_class</span><span class="p">;</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">ann_text</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/* Should be a list of [annotation class, [string, ...]]. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyList_Check</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted an annotation that is not a list&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Should have 2 elements. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kt">ssize_t</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted annotation list with %zd elements instead of 2&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/*</span>
<span class="cm">         * The first element should be an integer matching a previously</span>
<span class="cm">         * registered annotation class.</span>
<span class="cm">         */</span>
<span class="w">        </span><span class="n">py_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyLong_Check</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted annotation list, but first element was not an integer.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">ann_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyLong_AsLong</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">pdo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_nth_data</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">annotations</span><span class="p">,</span><span class="w"> </span><span class="n">ann_class</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted data to unregistered annotation class %d.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ann_class</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Second element must be a list. */</span>
<span class="w">        </span><span class="n">py_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyList_Check</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted annotation list, but second element was not a list.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">py_strseq_to_char</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ann_text</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted annotation list, but second element was malformed.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">pda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">        </span><span class="n">pda</span><span class="o">-&gt;</span><span class="n">ann_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ann_class</span><span class="p">;</span>
<span class="w">        </span><span class="n">pda</span><span class="o">-&gt;</span><span class="n">ann_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ann_text</span><span class="p">;</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_PYTHON</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_logic</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_logic</span><span class="w"> </span><span class="o">*</span><span class="n">pdl</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pdl</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="n">g_free</span><span class="p">((</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pdl</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_logic</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="p">,</span>
<span class="w">                </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="n">pdata</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_logic</span><span class="w"> </span><span class="o">*</span><span class="n">pdl</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_tmp</span><span class="p">;</span>
<span class="w">        </span><span class="n">Py_ssize_t</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">logic_group</span><span class="p">;</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">group_name</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/* Should be a list of [logic group, bytes]. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyList_Check</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted non-list for OTD_OUTPUT_LOGIC.&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Should have 2 elements. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_LOGIC list &quot;</span>
<span class="w">                                </span><span class="s">&quot;with %zd elements instead of 2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span>
<span class="w">                                </span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">obj</span><span class="p">));</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* The first element should be an integer. */</span>
<span class="w">        </span><span class="n">py_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyLong_Check</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_LOGIC list, &quot;</span>
<span class="w">                        </span><span class="s">&quot;but first element was not an integer.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">logic_group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyLong_AsLong</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_nth_data</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">logic_output_channels</span><span class="p">,</span><span class="w"> </span><span class="n">logic_group</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_LOGIC with &quot;</span>
<span class="w">                        </span><span class="s">&quot;unregistered logic group %d.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">logic_group</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Second element should be bytes. */</span>
<span class="w">        </span><span class="n">py_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyBytes_Check</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_LOGIC list, &quot;</span>
<span class="w">                        </span><span class="s">&quot;but second element was not bytes.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Consider an empty set of bytes a bug. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyBytes_Size</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_LOGIC &quot;</span>
<span class="w">                                </span><span class="s">&quot;with empty data set.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyBytes_AsStringAndSize</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="n">pdl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdl</span><span class="o">-&gt;</span><span class="n">logic_group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logic_group</span><span class="p">;</span>
<span class="w">        </span><span class="cm">/* pdl-&gt;repeat_count is set by the caller as it depends on the sample range */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">pdl</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_try_malloc</span><span class="p">(</span><span class="n">size</span><span class="p">)))</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_MALLOC</span><span class="p">;</span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">((</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pdl</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_PYTHON</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_binary</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_binary</span><span class="w"> </span><span class="o">*</span><span class="n">pdb</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">pdb</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="n">g_free</span><span class="p">((</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pdb</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_binary</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="p">,</span>
<span class="w">                </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="n">pdata</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_binary</span><span class="w"> </span><span class="o">*</span><span class="n">pdb</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_tmp</span><span class="p">;</span>
<span class="w">        </span><span class="n">Py_ssize_t</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">bin_class</span><span class="p">;</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">class_name</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/* Should be a list of [binary class, bytes]. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyList_Check</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted non-list for OTD_OUTPUT_BINARY.&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Should have 2 elements. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kt">ssize_t</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_BINARY list with %zd elements instead of 2&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* The first element should be an integer. */</span>
<span class="w">        </span><span class="n">py_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyLong_Check</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_BINARY list, but first element was not an integer.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">bin_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyLong_AsLong</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">class_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_nth_data</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">binary</span><span class="p">,</span><span class="w"> </span><span class="n">bin_class</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_BINARY with unregistered binary class %d.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bin_class</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Second element should be bytes. */</span>
<span class="w">        </span><span class="n">py_tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyBytes_Check</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_BINARY list, but second element was not bytes.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Consider an empty set of bytes a bug. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyBytes_Size</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted OTD_OUTPUT_BINARY with empty data set.&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyBytes_AsStringAndSize</span><span class="p">(</span><span class="n">py_tmp</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="n">pdb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdb</span><span class="o">-&gt;</span><span class="n">bin_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bin_class</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdb</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">pdb</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_try_malloc</span><span class="p">(</span><span class="n">pdb</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">)))</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_MALLOC</span><span class="p">;</span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">((</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">pdb</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">pdb</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_PYTHON</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">otd_sess_inst_find_by_obj</span><span class="p">(</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_session</span><span class="w"> </span><span class="o">*</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">stack</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">sess</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">        </span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">sess</span><span class="o">-&gt;</span><span class="n">di_list</span><span class="p">;</span><span class="w"> </span><span class="n">di</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">py_inst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span>
<span class="w">                        </span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">next_di</span><span class="p">)</span>
<span class="w">                        </span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_sess_inst_find_by_obj</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="o">-&gt;</span><span class="n">next_di</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">di</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Find a decoder instance by its Python object.</span>
<span class="cm"> *</span>
<span class="cm"> * I.e. find that instance&#39;s instantiation of the opentracedecode.Decoder class.</span>
<span class="cm"> * This will recurse to find the instance anywhere in the stack tree of all</span>
<span class="cm"> * sessions.</span>
<span class="cm"> *</span>
<span class="cm"> * @param stack Pointer to a GSList of struct otd_decoder_inst, indicating the</span>
<span class="cm"> *              stack to search. To start searching at the bottom level of</span>
<span class="cm"> *              decoder instances, pass NULL.</span>
<span class="cm"> * @param obj The Python class instantiation.</span>
<span class="cm"> *</span>
<span class="cm"> * @return Pointer to struct otd_decoder_inst, or NULL if not found.</span>
<span class="cm"> *</span>
<span class="cm"> * @since 0.1.0</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="kr">inline</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">otd_inst_find_by_obj</span><span class="p">(</span>
<span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">stack</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_session</span><span class="w"> </span><span class="o">*</span><span class="n">sess</span><span class="p">;</span>
<span class="w">        </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/* Performance shortcut: Handle the most common case first. */</span>
<span class="w">        </span><span class="n">sess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sessions</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">        </span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sess</span><span class="o">-&gt;</span><span class="n">di_list</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">py_inst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">di</span><span class="p">;</span>

<span class="w">        </span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sessions</span><span class="p">;</span><span class="w"> </span><span class="n">di</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">sess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">                </span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_sess_inst_find_by_obj</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">stack</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">di</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">convert_meta</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="o">*</span><span class="n">pdata</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">obj</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">intvalue</span><span class="p">;</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">dvalue</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_variant_type_equal</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">meta_type</span><span class="p">,</span><span class="w"> </span><span class="n">G_VARIANT_TYPE_INT64</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyLong_Check</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">PyErr_Format</span><span class="p">(</span><span class="n">PyExc_TypeError</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;This output was registered as &#39;int&#39;, but something else was passed.&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">intvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyLong_AsLongLong</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyErr_Occurred</span><span class="p">())</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_variant_new_int64</span><span class="p">(</span><span class="n">intvalue</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">g_variant_type_equal</span><span class="p">(</span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">meta_type</span><span class="p">,</span><span class="w"> </span><span class="n">G_VARIANT_TYPE_DOUBLE</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyFloat_Check</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">PyErr_Format</span><span class="p">(</span><span class="n">PyExc_TypeError</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;This output was registered as &#39;float&#39;, but something else was passed.&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">dvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyFloat_AsDouble</span><span class="p">(</span><span class="n">obj</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyErr_Occurred</span><span class="p">())</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="n">pdata</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_variant_new_double</span><span class="p">(</span><span class="n">dvalue</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_PYTHON</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">release_meta</span><span class="p">(</span><span class="n">GVariant</span><span class="w"> </span><span class="o">*</span><span class="n">gvar</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">gvar</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="n">g_variant_unref</span><span class="p">(</span><span class="n">gvar</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">PyDoc_STRVAR</span><span class="p">(</span><span class="n">Decoder_put_doc</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;Put an annotation for the specified span of samples.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;Arguments: start and end sample number, stream id, annotation data.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;Annotation data&#39;s layout depends on the output stream type.&quot;</span>
<span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="nf">Decoder_put</span><span class="p">(</span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_data</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">py_res</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">next_di</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_pd_output</span><span class="w"> </span><span class="o">*</span><span class="n">pdo</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data</span><span class="w"> </span><span class="n">pdata</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_annotation</span><span class="w"> </span><span class="n">pda</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_binary</span><span class="w"> </span><span class="n">pdb</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_proto_data_logic</span><span class="w"> </span><span class="n">pdl</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">start_sample</span><span class="p">,</span><span class="w"> </span><span class="n">end_sample</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">output_id</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_pd_callback</span><span class="w"> </span><span class="o">*</span><span class="n">cb</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="n">py_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_inst_find_by_obj</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* Shouldn&#39;t happen. */</span>
<span class="w">                </span><span class="n">otd_dbg</span><span class="p">(</span><span class="s">&quot;put(): self instance not found.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyArg_ParseTuple</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;KKiO&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">start_sample</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">end_sample</span><span class="p">,</span>
<span class="w">                </span><span class="o">&amp;</span><span class="n">output_id</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">py_data</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/*</span>
<span class="cm">                 * This throws an exception, but by returning NULL here we let</span>
<span class="cm">                 * Python raise it. This results in a much better trace in</span>
<span class="cm">                 * controller.c on the decode() method call.</span>
<span class="cm">                 */</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_nth</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">pd_output</span><span class="p">,</span><span class="w"> </span><span class="n">output_id</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted invalid output ID %d.&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">output_id</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">pdo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/* Upon OTD_OUTPUT_PYTHON for stacked PDs, we have a nicer log message later. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OUTPUT_PYTHON</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">next_di</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_spew</span><span class="p">(</span><span class="s">&quot;Instance %s put %&quot;</span><span class="w"> </span><span class="n">PRIu64</span><span class="w"> </span><span class="s">&quot;-%&quot;</span><span class="w"> </span><span class="n">PRIu64</span><span class="w"> </span><span class="s">&quot; %s on &quot;</span>
<span class="w">                         </span><span class="s">&quot;oid %d (%s).&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">start_sample</span><span class="p">,</span><span class="w"> </span><span class="n">end_sample</span><span class="p">,</span>
<span class="w">                         </span><span class="n">output_type_name</span><span class="p">(</span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">),</span><span class="w"> </span><span class="n">output_id</span><span class="p">,</span>
<span class="w">                         </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">proto_id</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">pdata</span><span class="p">.</span><span class="n">start_sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start_sample</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdata</span><span class="p">.</span><span class="n">end_sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end_sample</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdata</span><span class="p">.</span><span class="n">pdo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdo</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">OTD_OUTPUT_ANN</span><span class="p">:</span>
<span class="w">                </span><span class="cm">/* Annotations are only fed to callbacks. */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">cb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_pd_output_callback_find</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pda</span><span class="p">;</span>
<span class="w">                        </span><span class="cm">/* Convert from PyDict to otd_proto_data_annotation. */</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convert_annotation</span><span class="p">(</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">py_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="cm">/* An error was already logged. */</span>
<span class="w">                                </span><span class="k">break</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="n">Py_BEGIN_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">,</span><span class="w"> </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb_data</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Py_END_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">release_annotation</span><span class="p">(</span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">OTD_OUTPUT_PYTHON</span><span class="p">:</span>
<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">next_di</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">next_di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">                        </span><span class="n">otd_spew</span><span class="p">(</span><span class="s">&quot;Instance %s put %&quot;</span><span class="w"> </span><span class="n">PRIu64</span><span class="w"> </span><span class="s">&quot;-%&quot;</span><span class="w"> </span><span class="n">PRIu64</span><span class="w"> </span><span class="s">&quot; %s &quot;</span>
<span class="w">                                 </span><span class="s">&quot;on oid %d (%s) to instance %s.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span>
<span class="w">                                 </span><span class="n">start_sample</span><span class="p">,</span>
<span class="w">                                 </span><span class="n">end_sample</span><span class="p">,</span><span class="w"> </span><span class="n">output_type_name</span><span class="p">(</span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">),</span>
<span class="w">                                 </span><span class="n">output_id</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">proto_id</span><span class="p">,</span><span class="w"> </span><span class="n">next_di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">);</span>
<span class="w">                        </span><span class="n">py_res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyObject_CallMethod</span><span class="p">(</span><span class="n">next_di</span><span class="o">-&gt;</span><span class="n">py_inst</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;decode&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s">&quot;KKO&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">start_sample</span><span class="p">,</span><span class="w"> </span><span class="n">end_sample</span><span class="p">,</span><span class="w"> </span><span class="n">py_data</span><span class="p">);</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">py_res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">otd_exception_catch</span><span class="p">(</span><span class="s">&quot;Calling %s decode() failed&quot;</span><span class="p">,</span>
<span class="w">                                                        </span><span class="n">next_di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">);</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="n">Py_XDECREF</span><span class="p">(</span><span class="n">py_res</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">cb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_pd_output_callback_find</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="cm">/*</span>
<span class="cm">                         * Frontends aren&#39;t really supposed to get Python</span>
<span class="cm">                         * callbacks, but it&#39;s useful for testing.</span>
<span class="cm">                         */</span>
<span class="w">                        </span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">py_data</span><span class="p">;</span>
<span class="w">                        </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">,</span><span class="w"> </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb_data</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">OTD_OUTPUT_BINARY</span><span class="p">:</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">cb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_pd_output_callback_find</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pdb</span><span class="p">;</span>
<span class="w">                        </span><span class="cm">/* Convert from PyDict to otd_proto_data_binary. */</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convert_binary</span><span class="p">(</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">py_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="cm">/* An error was already logged. */</span>
<span class="w">                                </span><span class="k">break</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="n">Py_BEGIN_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">,</span><span class="w"> </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb_data</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Py_END_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">release_binary</span><span class="p">(</span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">OTD_OUTPUT_LOGIC</span><span class="p">:</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">cb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_pd_output_callback_find</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pdl</span><span class="p">;</span>
<span class="w">                        </span><span class="cm">/* Convert from PyDict to otd_proto_data_logic. */</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convert_logic</span><span class="p">(</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">py_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="cm">/* An error was already logged. */</span>
<span class="w">                                </span><span class="k">break</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">end_sample</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">start_sample</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Ignored OTD_OUTPUT_LOGIC with invalid sample range.&quot;</span><span class="p">);</span>
<span class="w">                                </span><span class="k">break</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="n">pdl</span><span class="p">.</span><span class="n">repeat_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">end_sample</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_sample</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                        </span><span class="n">Py_BEGIN_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">,</span><span class="w"> </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb_data</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Py_END_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">release_logic</span><span class="p">(</span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="no">OTD_OUTPUT_META</span><span class="p">:</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">cb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_pd_output_callback_find</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">sess</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="cm">/* Annotations need converting from PyObject. */</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convert_meta</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">,</span><span class="w"> </span><span class="n">py_data</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="cm">/* An exception was already set up. */</span>
<span class="w">                                </span><span class="k">break</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="n">Py_BEGIN_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdata</span><span class="p">,</span><span class="w"> </span><span class="n">cb</span><span class="o">-&gt;</span><span class="n">cb_data</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Py_END_ALLOW_THREADS</span>
<span class="w">                        </span><span class="n">release_meta</span><span class="p">(</span><span class="n">pdata</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Protocol decoder %s submitted invalid output type %d.&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="n">Py_RETURN_NONE</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">PyDoc_STRVAR</span><span class="p">(</span><span class="n">Decoder_register_doc</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;Register a new output stream.&quot;</span>
<span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="nf">Decoder_register</span><span class="p">(</span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">self</span><span class="p">,</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">kwargs</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_pd_output</span><span class="w"> </span><span class="o">*</span><span class="n">pdo</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_new_output_id</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyTypeObject</span><span class="w"> </span><span class="o">*</span><span class="n">meta_type_py</span><span class="p">;</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">GVariantType</span><span class="w"> </span><span class="o">*</span><span class="n">meta_type_gv</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">output_type</span><span class="p">;</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">proto_id</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">meta_name</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">meta_descr</span><span class="p">;</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">keywords</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;output_type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;proto_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;meta&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="p">};</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>
<span class="w">        </span><span class="n">gboolean</span><span class="w"> </span><span class="n">is_meta</span><span class="p">;</span>
<span class="w">        </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">l</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_pd_output</span><span class="w"> </span><span class="o">*</span><span class="n">cmp</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="n">meta_type_py</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">        </span><span class="n">meta_type_gv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">        </span><span class="n">meta_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meta_descr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_inst_find_by_obj</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">PyErr_SetString</span><span class="p">(</span><span class="n">PyExc_Exception</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;decoder instance not found&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Default to instance ID, which defaults to class ID. */</span>
<span class="w">        </span><span class="n">proto_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyArg_ParseTupleAndKeywords</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">kwargs</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;i|s(Oss)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">keywords</span><span class="p">,</span>
<span class="w">                        </span><span class="o">&amp;</span><span class="n">output_type</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">proto_id</span><span class="p">,</span>
<span class="w">                        </span><span class="o">&amp;</span><span class="n">meta_type_py</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">meta_name</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">meta_descr</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* Let Python raise this exception. */</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Check if the meta value&#39;s type is supported. */</span>
<span class="w">        </span><span class="n">is_meta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">OTD_OUTPUT_META</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_meta</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">meta_type_py</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">&amp;</span><span class="n">PyLong_Type</span><span class="p">)</span>
<span class="w">                        </span><span class="n">meta_type_gv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">G_VARIANT_TYPE_INT64</span><span class="p">;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">meta_type_py</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">&amp;</span><span class="n">PyFloat_Type</span><span class="p">)</span>
<span class="w">                        </span><span class="n">meta_type_gv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">G_VARIANT_TYPE_DOUBLE</span><span class="p">;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">PyErr_Format</span><span class="p">(</span><span class="n">PyExc_TypeError</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unsupported type.&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">pdo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">pd_output</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="p">;</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">cmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cmp</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">output_type</span><span class="p">)</span>
<span class="w">                        </span><span class="k">continue</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">cmp</span><span class="o">-&gt;</span><span class="n">proto_id</span><span class="p">,</span><span class="w"> </span><span class="n">proto_id</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                        </span><span class="k">continue</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_meta</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cmp</span><span class="o">-&gt;</span><span class="n">meta_type</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">meta_type_gv</span><span class="p">)</span>
<span class="w">                        </span><span class="k">continue</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_meta</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">strcmp</span><span class="p">(</span><span class="n">cmp</span><span class="o">-&gt;</span><span class="n">meta_name</span><span class="p">,</span><span class="w"> </span><span class="n">meta_name</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                        </span><span class="k">continue</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_meta</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">strcmp</span><span class="p">(</span><span class="n">cmp</span><span class="o">-&gt;</span><span class="n">meta_descr</span><span class="p">,</span><span class="w"> </span><span class="n">meta_descr</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                        </span><span class="k">continue</span><span class="p">;</span>
<span class="w">                </span><span class="n">pdo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmp</span><span class="p">;</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pdo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">py_new_output_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Py_BuildValue</span><span class="p">(</span><span class="s">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">pdo_id</span><span class="p">);</span>
<span class="w">                </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">py_new_output_id</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">pdo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_pd_output</span><span class="p">));</span>

<span class="w">        </span><span class="cm">/* pdo_id is just a simple index, nothing is deleted from this list anyway. */</span>
<span class="w">        </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">pdo_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_length</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">pd_output</span><span class="p">);</span>
<span class="w">        </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">output_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output_type</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">di</span><span class="p">;</span>
<span class="w">        </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">proto_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="p">(</span><span class="n">proto_id</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">output_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">OTD_OUTPUT_META</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">meta_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">meta_type_gv</span><span class="p">;</span>
<span class="w">                </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">meta_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="p">(</span><span class="n">meta_name</span><span class="p">);</span>
<span class="w">                </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">meta_descr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_strdup</span><span class="p">(</span><span class="n">meta_descr</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">pd_output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_append</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">pd_output</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="p">);</span>
<span class="w">        </span><span class="n">py_new_output_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Py_BuildValue</span><span class="p">(</span><span class="s">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">pdo_id</span><span class="p">);</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="n">otd_dbg</span><span class="p">(</span><span class="s">&quot;Instance %s creating new output type %s as oid %d (%s).&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">output_type_name</span><span class="p">(</span><span class="n">output_type</span><span class="p">),</span><span class="w"> </span><span class="n">pdo</span><span class="o">-&gt;</span><span class="n">pdo_id</span><span class="p">,</span>
<span class="w">                </span><span class="n">proto_id</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">py_new_output_id</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">get_term_type</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;h&#39;</span><span class="p">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_TERM_HIGH</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="p">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_TERM_LOW</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="p">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_TERM_RISING_EDGE</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;f&#39;</span><span class="p">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_TERM_FALLING_EDGE</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_TERM_EITHER_EDGE</span><span class="p">;</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="sc">&#39;n&#39;</span><span class="p">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_TERM_NO_EDGE</span><span class="p">;</span>
<span class="w">        </span><span class="k">default</span><span class="o">:</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Get the pin values at the current sample number.</span>
<span class="cm"> *</span>
<span class="cm"> * @param di The decoder instance to use. Must not be NULL.</span>
<span class="cm"> *           The number of channels must be &gt;= 1.</span>
<span class="cm"> *</span>
<span class="cm"> * @return A newly allocated PyTuple containing the pin values at the</span>
<span class="cm"> *         current sample number.</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="nf">get_current_pinvalues</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">sample</span><span class="p">;</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="n">sample_pos</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">byte_offset</span><span class="p">,</span><span class="w"> </span><span class="n">bit_offset</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_pinvalues</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">di</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Invalid decoder instance.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="n">py_pinvalues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyTuple_New</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">dec_num_channels</span><span class="p">);</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">dec_num_channels</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* A channelmap value of -1 means &quot;unused optional channel&quot;. */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">dec_channelmap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="cm">/* Value of unused channel is 0xff, instead of 0 or 1. */</span>
<span class="w">                        </span><span class="n">PyTuple_SetItem</span><span class="p">(</span><span class="n">py_pinvalues</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">PyLong_FromUnsignedLong</span><span class="p">(</span><span class="mh">0xff</span><span class="p">));</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">sample_pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inbuf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">abs_cur_samplenum</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">abs_start_samplenum</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">data_unitsize</span><span class="p">);</span>
<span class="w">                        </span><span class="n">byte_offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">dec_channelmap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
<span class="w">                        </span><span class="n">bit_offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">dec_channelmap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
<span class="w">                        </span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">sample_pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">byte_offset</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">bit_offset</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">                        </span><span class="n">PyTuple_SetItem</span><span class="p">(</span><span class="n">py_pinvalues</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">PyLong_FromUnsignedLong</span><span class="p">(</span><span class="n">sample</span><span class="p">));</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">py_pinvalues</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Create a list of terms in the specified condition.</span>
<span class="cm"> *</span>
<span class="cm"> * If there are no terms in the condition, &#39;term_list&#39; will be NULL.</span>
<span class="cm"> *</span>
<span class="cm"> * @param di The decoder instance to use. Must not be NULL.</span>
<span class="cm"> * @param py_dict A Python dict containing terms. Must not be NULL.</span>
<span class="cm"> * @param term_list Pointer to a GSList which will be set to the newly</span>
<span class="cm"> *                  created list of terms. Must not be NULL.</span>
<span class="cm"> *</span>
<span class="cm"> * @return OTD_OK upon success, a negative error code otherwise.</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">create_term_list</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">,</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_dict</span><span class="p">,</span><span class="w"> </span><span class="n">GSList</span><span class="w"> </span><span class="o">**</span><span class="n">term_list</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">Py_ssize_t</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_key</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">py_value</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_term</span><span class="w"> </span><span class="o">*</span><span class="n">term</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">num_samples_to_skip</span><span class="p">;</span>
<span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">term_str</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">py_dict</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">term_list</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_ARG</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/* &quot;Create&quot; an empty GSList of terms. */</span>
<span class="w">        </span><span class="o">*</span><span class="n">term_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/* Iterate over all items in the current dict. */</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">PyDict_Next</span><span class="p">(</span><span class="n">py_dict</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pos</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">py_key</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">py_value</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* Check whether the current key is a string or a number. */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyLong_Check</span><span class="p">(</span><span class="n">py_key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="cm">/* The key is a number. */</span>
<span class="w">                        </span><span class="cm">/* Get the value string. */</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">py_pydictitem_as_str</span><span class="p">(</span><span class="n">py_dict</span><span class="p">,</span><span class="w"> </span><span class="n">py_key</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">term_str</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Failed to get the value.&quot;</span><span class="p">);</span>
<span class="w">                                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_term</span><span class="p">));</span>
<span class="w">                        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_term_type</span><span class="p">(</span><span class="n">term_str</span><span class="p">);</span>
<span class="w">                        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyLong_AsLong</span><span class="p">(</span><span class="n">py_key</span><span class="p">);</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">term</span><span class="o">-&gt;</span><span class="n">channel</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">channel</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">dec_num_channels</span><span class="p">)</span>
<span class="w">                                </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OTD_TERM_ALWAYS_FALSE</span><span class="p">;</span>
<span class="w">                        </span><span class="n">g_free</span><span class="p">(</span><span class="n">term_str</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyUnicode_Check</span><span class="p">(</span><span class="n">py_key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="cm">/* The key is a string. */</span>
<span class="w">                        </span><span class="cm">/* TODO: Check if the key is &quot;skip&quot;. */</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">py_pydictitem_as_long</span><span class="p">(</span><span class="n">py_dict</span><span class="p">,</span><span class="w"> </span><span class="n">py_key</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">num_samples_to_skip</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Failed to get number of samples to skip.&quot;</span><span class="p">);</span>
<span class="w">                                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_term</span><span class="p">));</span>
<span class="w">                        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OTD_TERM_SKIP</span><span class="p">;</span>
<span class="w">                        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">num_samples_to_skip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_samples_to_skip</span><span class="p">;</span>
<span class="w">                        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">num_samples_already_skipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_samples_to_skip</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                                </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OTD_TERM_ALWAYS_FALSE</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Term key is neither a string nor a number.&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="cm">/* Add the term to the list of terms. */</span>
<span class="w">                </span><span class="o">*</span><span class="n">term_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_append</span><span class="p">(</span><span class="o">*</span><span class="n">term_list</span><span class="p">,</span><span class="w"> </span><span class="n">term</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Replace the current condition list with the new one.</span>
<span class="cm"> *</span>
<span class="cm"> * @param self TODO. Must not be NULL.</span>
<span class="cm"> * @param args TODO. Must not be NULL.</span>
<span class="cm"> *</span>
<span class="cm"> * @retval OTD_OK The new condition list was set successfully.</span>
<span class="cm"> * @retval OTD_ERR There was an error setting the new condition list.</span>
<span class="cm"> *                 The contents of di-&gt;condition_list are undefined.</span>
<span class="cm"> * @retval 9999 TODO.</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">set_new_condition_list</span><span class="p">(</span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">;</span>
<span class="w">        </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">term_list</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_conditionlist</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">py_conds</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">py_dict</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">num_conditions</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">self</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">args</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR_ARG</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="cm">/* Get the decoder instance. */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_inst_find_by_obj</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">PyErr_SetString</span><span class="p">(</span><span class="n">PyExc_Exception</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;decoder instance not found&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/*</span>
<span class="cm">         * Return an error condition from .wait() when termination is</span>
<span class="cm">         * requested, such that decode() will terminate.</span>
<span class="cm">         */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">want_wait_terminate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_dbg</span><span class="p">(</span><span class="s">&quot;%s: %s: Skip (want_term).&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/*</span>
<span class="cm">         * Parse the argument of self.wait() into &#39;py_conds&#39;, and check</span>
<span class="cm">         * the data type. The argument is optional, None is assumed in</span>
<span class="cm">         * its absence. None or an empty dict or an empty list mean that</span>
<span class="cm">         * there is no condition, and the next available sample shall</span>
<span class="cm">         * get returned to the caller.</span>
<span class="cm">         */</span>
<span class="w">        </span><span class="n">py_conds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Py_None</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyArg_ParseTuple</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;|O&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">py_conds</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* Let Python raise this exception. */</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">py_conds</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Py_None</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* &#39;py_conds&#39; is None. */</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">ret_9999</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyList_Check</span><span class="p">(</span><span class="n">py_conds</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* &#39;py_conds&#39; is a list. */</span>
<span class="w">                </span><span class="n">py_conditionlist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">py_conds</span><span class="p">;</span>
<span class="w">                </span><span class="n">num_conditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_Size</span><span class="p">(</span><span class="n">py_conditionlist</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_conditions</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">ret_9999</span><span class="p">;</span><span class="w"> </span><span class="cm">/* The PD invoked self.wait([]). */</span>
<span class="w">                </span><span class="n">Py_INCREF</span><span class="p">(</span><span class="n">py_conditionlist</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyDict_Check</span><span class="p">(</span><span class="n">py_conds</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* &#39;py_conds&#39; is a dict. */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyDict_Size</span><span class="p">(</span><span class="n">py_conds</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">ret_9999</span><span class="p">;</span><span class="w"> </span><span class="cm">/* The PD invoked self.wait({}). */</span>
<span class="w">                </span><span class="cm">/* Make a list and put the dict in there for convenience. */</span>
<span class="w">                </span><span class="n">py_conditionlist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_New</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">                </span><span class="n">Py_INCREF</span><span class="p">(</span><span class="n">py_conds</span><span class="p">);</span>
<span class="w">                </span><span class="n">PyList_SetItem</span><span class="p">(</span><span class="n">py_conditionlist</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">py_conds</span><span class="p">);</span>
<span class="w">                </span><span class="n">num_conditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Condition list is neither a list nor a dict.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/* Free the old condition list. */</span>
<span class="w">        </span><span class="n">condition_list_free</span><span class="p">(</span><span class="n">di</span><span class="p">);</span>

<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">;</span>

<span class="w">        </span><span class="cm">/* Iterate over the conditions, set di-&gt;condition_list accordingly. */</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_conditions</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* Get a condition (dict) from the condition list. */</span>
<span class="w">                </span><span class="n">py_dict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyList_GetItem</span><span class="p">(</span><span class="n">py_conditionlist</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyDict_Check</span><span class="p">(</span><span class="n">py_dict</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Condition is not a dict.&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OTD_ERR</span><span class="p">;</span>
<span class="w">                        </span><span class="k">break</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="cm">/* Create the list of terms in this condition. */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_term_list</span><span class="p">(</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">py_dict</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">term_list</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">                        </span><span class="k">break</span><span class="p">;</span>

<span class="w">                </span><span class="cm">/* Add the new condition to the PD instance&#39;s condition list. */</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">condition_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_append</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">condition_list</span><span class="p">,</span><span class="w"> </span><span class="n">term_list</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">Py_DecRef</span><span class="p">(</span><span class="n">py_conditionlist</span><span class="p">);</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_ERR</span><span class="p">;</span>

<span class="nl">ret_9999</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">9999</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Create a SKIP condition list for condition-less .wait() calls.</span>
<span class="cm"> *</span>
<span class="cm"> * @param di Decoder instance.</span>
<span class="cm"> * @param count Number of samples to skip.</span>
<span class="cm"> *</span>
<span class="cm"> * @retval OTD_OK The new condition list was set successfully.</span>
<span class="cm"> * @retval OTD_ERR There was an error setting the new condition list.</span>
<span class="cm"> *                 The contents of di-&gt;condition_list are undefined.</span>
<span class="cm"> *</span>
<span class="cm"> * This routine is a reduced and specialized version of the @ref</span>
<span class="cm"> * set_new_condition_list() and @ref create_term_list() routines which</span>
<span class="cm"> * gets invoked when .wait() was called without specifications for</span>
<span class="cm"> * conditions. This minor duplication of the SKIP term list creation</span>
<span class="cm"> * simplifies the logic and avoids the creation of expensive Python</span>
<span class="cm"> * objects with &quot;constant&quot; values which the caller did not pass in the</span>
<span class="cm"> * first place. It results in maximum sharing of match handling code</span>
<span class="cm"> * paths.</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">set_skip_condition</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">count</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_term</span><span class="w"> </span><span class="o">*</span><span class="n">term</span><span class="p">;</span>
<span class="w">        </span><span class="n">GSList</span><span class="w"> </span><span class="o">*</span><span class="n">term_list</span><span class="p">;</span>

<span class="w">        </span><span class="n">condition_list_free</span><span class="p">(</span><span class="n">di</span><span class="p">);</span>
<span class="w">        </span><span class="n">term</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">term</span><span class="p">));</span>
<span class="w">        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OTD_TERM_SKIP</span><span class="p">;</span>
<span class="w">        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">num_samples_to_skip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">        </span><span class="n">term</span><span class="o">-&gt;</span><span class="n">num_samples_already_skipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">term_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_append</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">term</span><span class="p">);</span>
<span class="w">        </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">condition_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_append</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">condition_list</span><span class="p">,</span><span class="w"> </span><span class="n">term_list</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">OTD_OK</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">PyDoc_STRVAR</span><span class="p">(</span><span class="n">Decoder_wait_doc</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;Wait for one or more conditions to occur.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;Returns the sample data at the next position where the condition</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;is seen. When the optional condition is missing or empty, the next</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;sample number is used. The condition can be a dictionary with one</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;condition&#39;s details, or a list of dictionaries specifying multiple</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;conditions of which at least one condition must be true. Dicts can</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;contain one or more key/value pairs, all of which must be true for</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;the dict&#39;s condition to be considered true. The key either is a</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;channel index or a keyword, the value is the operation&#39;s parameter.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;Supported parameters for channel number keys: &#39;h&#39;, &#39;l&#39;, &#39;r&#39;, &#39;f&#39;,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;or &#39;e&#39; for level or edge conditions. Other supported keywords:</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;&#39;skip&#39; to advance over the given number of samples.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="nf">Decoder_wait</span><span class="p">(</span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">        </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">skip_count</span><span class="p">;</span>
<span class="w">        </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="n">gboolean</span><span class="w"> </span><span class="n">found_match</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_pinvalues</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">py_matched</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">py_samplenum</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">self</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">args</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_inst_find_by_obj</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">PyErr_SetString</span><span class="p">(</span><span class="n">PyExc_Exception</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;decoder instance not found&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>
<span class="w">                </span><span class="n">Py_RETURN_NONE</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set_new_condition_list</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_dbg</span><span class="p">(</span><span class="s">&quot;%s: %s: Aborting wait().&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9999</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/*</span>
<span class="cm">                 * Empty condition list, automatic match. Arrange for the</span>
<span class="cm">                 * execution of regular match handling code paths such that</span>
<span class="cm">                 * the next available sample is returned to the caller.</span>
<span class="cm">                 * Make sure to skip one sample when &quot;anywhere within the</span>
<span class="cm">                 * stream&quot;, yet make sure to not skip sample number 0.</span>
<span class="cm">                 */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">abs_cur_samplenum</span><span class="p">)</span>
<span class="w">                        </span><span class="n">skip_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">condition_list</span><span class="p">)</span>
<span class="w">                        </span><span class="n">skip_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                        </span><span class="n">skip_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">                </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">set_skip_condition</span><span class="p">(</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="n">skip_count</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">otd_dbg</span><span class="p">(</span><span class="s">&quot;%s: %s: Cannot setup condition-less wait().&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">);</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="n">Py_BEGIN_ALLOW_THREADS</span>

<span class="w">                </span><span class="cm">/* Wait for new samples to process, or termination request. */</span>
<span class="w">                </span><span class="n">g_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">data_mutex</span><span class="p">);</span>
<span class="w">                </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">got_new_samples</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">want_wait_terminate</span><span class="p">)</span>
<span class="w">                        </span><span class="n">g_cond_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">got_new_samples_cond</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">data_mutex</span><span class="p">);</span>

<span class="w">                </span><span class="cm">/*</span>
<span class="cm">                 * Check whether any of the current condition(s) match.</span>
<span class="cm">                 * Arrange for termination requests to take a code path which</span>
<span class="cm">                 * won&#39;t find new samples to process, pretends to have processed</span>
<span class="cm">                 * previously stored samples, and returns to the main thread,</span>
<span class="cm">                 * while the termination request still gets signalled.</span>
<span class="cm">                 */</span>
<span class="w">                </span><span class="n">found_match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>

<span class="w">                </span><span class="cm">/* Ignore return value for now, should never be negative. */</span>
<span class="w">                </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">process_samples_until_condition_match</span><span class="p">(</span><span class="n">di</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">found_match</span><span class="p">);</span>

<span class="w">                </span><span class="n">Py_END_ALLOW_THREADS</span>

<span class="w">                </span><span class="cm">/* If there&#39;s a match, set self.samplenum etc. and return. */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">found_match</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="cm">/* Set self.samplenum to the (absolute) sample number that matched. */</span>
<span class="w">                        </span><span class="n">py_samplenum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyLong_FromUnsignedLongLong</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">abs_cur_samplenum</span><span class="p">);</span>
<span class="w">                        </span><span class="n">PyObject_SetAttrString</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">py_inst</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;samplenum&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">py_samplenum</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Py_DECREF</span><span class="p">(</span><span class="n">py_samplenum</span><span class="p">);</span>

<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">match_array</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">match_array</span><span class="o">-&gt;</span><span class="n">len</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">py_matched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyTuple_New</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">match_array</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">);</span>
<span class="w">                                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">match_array</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">                                        </span><span class="n">PyTuple_SetItem</span><span class="p">(</span><span class="n">py_matched</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">PyBool_FromLong</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">match_array</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
<span class="w">                                </span><span class="n">PyObject_SetAttrString</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">py_inst</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;matched&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">py_matched</span><span class="p">);</span>
<span class="w">                                </span><span class="n">Py_DECREF</span><span class="p">(</span><span class="n">py_matched</span><span class="p">);</span>
<span class="w">                                </span><span class="n">match_array_free</span><span class="p">(</span><span class="n">di</span><span class="p">);</span>
<span class="w">                        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="n">PyObject_SetAttrString</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">py_inst</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;matched&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Py_None</span><span class="p">);</span>
<span class="w">                        </span><span class="p">}</span>

<span class="w">                        </span><span class="n">py_pinvalues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_current_pinvalues</span><span class="p">(</span><span class="n">di</span><span class="p">);</span>

<span class="w">                        </span><span class="n">g_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">data_mutex</span><span class="p">);</span>

<span class="w">                        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">py_pinvalues</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="cm">/* No match, reset state for the next chunk. */</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">got_new_samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FALSE</span><span class="p">;</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">handled_all_samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">abs_start_samplenum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">abs_end_samplenum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inbuf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inbuflen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">                </span><span class="cm">/* Signal the main thread that we handled all samples. */</span>
<span class="w">                </span><span class="n">g_cond_signal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">handled_all_samples_cond</span><span class="p">);</span>

<span class="w">                </span><span class="cm">/*</span>
<span class="cm">                 * When EOF was provided externally, communicate the</span>
<span class="cm">                 * Python EOFError exception to .decode() and return</span>
<span class="cm">                 * from the .wait() method call. This is motivated by</span>
<span class="cm">                 * the use of Python context managers, so that .decode()</span>
<span class="cm">                 * methods can &quot;close&quot; incompletely accumulated data</span>
<span class="cm">                 * when the sample data is exhausted.</span>
<span class="cm">                 */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">communicate_eof</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="cm">/* Advance self.samplenum to the (absolute) last sample number. */</span>
<span class="w">                        </span><span class="n">py_samplenum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyLong_FromUnsignedLongLong</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">abs_cur_samplenum</span><span class="p">);</span>
<span class="w">                        </span><span class="n">PyObject_SetAttrString</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">py_inst</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;samplenum&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">py_samplenum</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Py_DECREF</span><span class="p">(</span><span class="n">py_samplenum</span><span class="p">);</span>
<span class="w">                        </span><span class="cm">/* Raise an EOFError Python exception. */</span>
<span class="w">                        </span><span class="n">otd_dbg</span><span class="p">(</span><span class="s">&quot;%s: %s: Raising EOF from wait().&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">);</span>
<span class="w">                        </span><span class="n">g_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">data_mutex</span><span class="p">);</span>
<span class="w">                        </span><span class="n">PyErr_SetString</span><span class="p">(</span><span class="n">PyExc_EOFError</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;samples exhausted&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="cm">/*</span>
<span class="cm">                 * When termination of wait() and decode() was requested,</span>
<span class="cm">                 * then exit the loop after releasing the mutex.</span>
<span class="cm">                 */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">want_wait_terminate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">otd_dbg</span><span class="p">(</span><span class="s">&quot;%s: %s: Will return from wait().&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="n">di</span><span class="o">-&gt;</span><span class="n">inst_id</span><span class="p">,</span><span class="w"> </span><span class="n">__func__</span><span class="p">);</span>
<span class="w">                        </span><span class="n">g_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">data_mutex</span><span class="p">);</span>
<span class="w">                        </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="n">g_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">data_mutex</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="n">Py_RETURN_NONE</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">PyDoc_STRVAR</span><span class="p">(</span><span class="n">Decoder_has_channel_doc</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;Check whether input data is supplied for a given channel.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;Argument: A channel index.</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;Returns: A boolean, True if the channel is connected,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;False if the channel is open (won&#39;t see any input data).</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * Return whether the specified channel was supplied to the decoder.</span>
<span class="cm"> *</span>
<span class="cm"> * @param self TODO. Must not be NULL.</span>
<span class="cm"> * @param args TODO. Must not be NULL.</span>
<span class="cm"> *</span>
<span class="cm"> * @retval Py_True The channel has been supplied by the frontend.</span>
<span class="cm"> * @retval Py_False The channel has been supplied by the frontend.</span>
<span class="cm"> * @retval NULL An error occurred.</span>
<span class="cm"> */</span>
<span class="k">static</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="nf">Decoder_has_channel</span><span class="p">(</span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">        </span><span class="k">struct</span><span class="w"> </span><span class="nc">otd_decoder_inst</span><span class="w"> </span><span class="o">*</span><span class="n">di</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">bool_ret</span><span class="p">;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">self</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">args</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">di</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otd_inst_find_by_obj</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">PyErr_SetString</span><span class="p">(</span><span class="n">PyExc_Exception</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;decoder instance not found&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="cm">/*</span>
<span class="cm">         * Get the integer argument of self.has_channel(). Check for</span>
<span class="cm">         * the range of supported PD input channel numbers.</span>
<span class="cm">         */</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PyArg_ParseTuple</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;i&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">idx</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="cm">/* Let Python raise this exception. */</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_slist_length</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">channels</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="n">g_slist_length</span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">decoder</span><span class="o">-&gt;</span><span class="n">opt_channels</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">otd_err</span><span class="p">(</span><span class="s">&quot;Invalid index %d, PD channel count %d.&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
<span class="w">                </span><span class="n">PyErr_SetString</span><span class="p">(</span><span class="n">PyExc_IndexError</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;invalid channel index&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="n">err</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="n">bool_ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">di</span><span class="o">-&gt;</span><span class="n">dec_channelmap</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">Py_False</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">Py_True</span><span class="p">;</span>
<span class="w">        </span><span class="n">Py_INCREF</span><span class="p">(</span><span class="n">bool_ret</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bool_ret</span><span class="p">;</span>

<span class="nl">err</span><span class="p">:</span>
<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">PyDoc_STRVAR</span><span class="p">(</span><span class="n">Decoder_doc</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sigrok Decoder base class&quot;</span><span class="p">);</span>

<span class="k">static</span><span class="w"> </span><span class="n">PyMethodDef</span><span class="w"> </span><span class="n">Decoder_methods</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;put&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">Decoder_put</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="p">,</span>
<span class="w">          </span><span class="n">Decoder_put_doc</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;register&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="p">(</span><span class="n">PyCFunction</span><span class="p">)(</span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="kt">void</span><span class="p">))</span><span class="n">Decoder_register</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">METH_KEYWORDS</span><span class="p">,</span>
<span class="w">          </span><span class="n">Decoder_register_doc</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;wait&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">Decoder_wait</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="p">,</span>
<span class="w">          </span><span class="n">Decoder_wait_doc</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;has_channel&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="n">Decoder_has_channel</span><span class="p">,</span><span class="w"> </span><span class="n">METH_VARARGS</span><span class="p">,</span>
<span class="w">          </span><span class="n">Decoder_has_channel_doc</span><span class="p">,</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">ALL_ZERO</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Create the opentracedecode.Decoder type.</span>
<span class="cm"> *</span>
<span class="cm"> * @return The new type object.</span>
<span class="cm"> *</span>
<span class="cm"> * @private</span>
<span class="cm"> */</span>
<span class="n">OTD_PRIV</span><span class="w"> </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">otd_Decoder_type_new</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">        </span><span class="n">PyType_Spec</span><span class="w"> </span><span class="n">spec</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyType_Slot</span><span class="w"> </span><span class="n">slots</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="n">Py_tp_doc</span><span class="p">,</span><span class="w"> </span><span class="n">Decoder_doc</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="n">Py_tp_methods</span><span class="p">,</span><span class="w"> </span><span class="n">Decoder_methods</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="n">Py_tp_new</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">PyType_GenericNew</span><span class="w"> </span><span class="p">},</span>
<span class="w">                </span><span class="n">ALL_ZERO</span><span class="p">,</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">        </span><span class="n">PyObject</span><span class="w"> </span><span class="o">*</span><span class="n">py_obj</span><span class="p">;</span>
<span class="w">        </span><span class="n">PyGILState_STATE</span><span class="w"> </span><span class="n">gstate</span><span class="p">;</span>

<span class="w">        </span><span class="n">gstate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyGILState_Ensure</span><span class="p">();</span>

<span class="w">        </span><span class="n">spec</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;opentracedecode.Decoder&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">spec</span><span class="p">.</span><span class="n">basicsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">otd_Decoder</span><span class="p">);</span>
<span class="w">        </span><span class="n">spec</span><span class="p">.</span><span class="n">itemsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">spec</span><span class="p">.</span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Py_TPFLAGS_DEFAULT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Py_TPFLAGS_BASETYPE</span><span class="p">;</span>
<span class="w">        </span><span class="n">spec</span><span class="p">.</span><span class="n">slots</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slots</span><span class="p">;</span>

<span class="w">        </span><span class="n">py_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PyType_FromSpec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">spec</span><span class="p">);</span>

<span class="w">        </span><span class="n">PyGILState_Release</span><span class="p">(</span><span class="n">gstate</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">py_obj</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<p>Updated on 2025-09-30 at 04:01:17 +0000</p>







  
  






                
  <button id="otl-report-issue"
        title="Report issue (includes your selection)"
        class="md-button md-button--primary"
        style="position: fixed; right: 1rem; bottom: 1.2rem; z-index: 999;">
  Report issue
</button>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">

        <small>
          Portions of this documentation are adapted from the sigrok project (CC-BY-SA 3.0).
          OpenTraceLab documentation is licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC-BY-SA 4.0).
        </small>
      </div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.top", "navigation.tabs", "navigation.sections", "navigation.footer", "content.action.edit", "content.action.view", "toc.integrate", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../overrides/assets/javascripts/report-issue.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
    
  </body>
</html>